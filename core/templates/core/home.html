<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Shortly — URL Shortener{% endblock %}</title>
  <meta name="description" content="Shorten links, set expirations and track clicks." />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-slate-700 antialiased">

  <!-- NAV -->
  <header class="bg-white border-b shadow-sm">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-indigo-600 text-white flex items-center justify-center rounded-lg font-bold">S</div>
        <div>
          <h1 class="text-lg font-semibold">Shortly</h1>
          <p class="text-xs text-slate-400">Simple. Fast. Private.</p>
        </div>
      </div>
      <nav class="text-sm text-slate-600 flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4">
        <a href="/" class="{% if request.path == '/' %}text-indigo-600 font-semibold{% else %}hover:text-slate-900{% endif %}">Home</a>
        <a href="/dashboard/" class="{% if '/dashboard' in request.path %}text-indigo-600 font-semibold{% else %}hover:text-slate-900{% endif %}">Dashboard</a>

        {% if request.user.is_authenticated %}
          <span class="mr-2">Hi, {{ request.user.username }}</span>
          <form action="{% url 'logout' %}" method="post" class="inline">
            {% csrf_token %}
            <button type="submit" class="px-3 py-1 rounded-md bg-red-600 text-white hover:bg-red-700">Logout</button>
          </form>
        {% else %}
          <a href="{% url 'login' %}" class="hover:text-slate-900">Log in</a>
          <a href="{% url 'signup' %}" class="px-3 py-1 rounded-md bg-indigo-600 text-white hover:bg-indigo-700">Sign up</a>
        {% endif %}
      </nav>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    {% block content %}
    
      <!-- URL Shortener Form (included) -->
      {% include "core/shortener_form.html" %}

      <!-- Stats for authenticated users -->
      {% if request.user.is_authenticated %}
        <div class="mt-8">
          <h3 class="text-lg font-semibold mb-2">Your Shortened Links</h3>
          {% if recent_links %}
            <ul class="space-y-2">
              {% for link in recent_links %}
                <li>
                  <a href="{{ link.original_url }}" class="text-indigo-600 underline">{{ link.original_url }}</a>
                  →
                  <a href="/{{ link.short_code }}" class="text-green-600 underline">{{ request.get_host }}/{{ link.short_code }}</a>
                  ({{ link.clicks }} clicks)
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-gray-500">You haven’t created any links yet.</p>
          {% endif %}
        </div>
      {% endif %}

    {% endblock %}
  </main>

  <!-- FOOTER -->
  <footer class="border-t bg-white">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6 flex flex-col sm:flex-row items-center justify-between text-sm text-slate-500 gap-2 sm:gap-0">
      <div>© {% now "Y" %} Shortly — Built with ❤️</div>
      <div class="space-x-4">
        <a href="/privacy/" class="hover:underline">Privacy</a>
        <a href="/terms/" class="hover:underline">Terms</a>
      </div>
    </div>
  </footer>

</body>
</html>
